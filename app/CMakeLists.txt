INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/include)

ADD_DEFINITIONS(-DCHARON_CORE_VERSION="${${PROJECT_NAME}_VERSION}")

ADD_EXECUTABLE(charon charon.cpp)
TARGET_LINK_LIBRARIES(charon charon-plugins)
SET_TARGET_PROPERTIES(charon PROPERTIES
	INSTALL_RPATH "${CMAKE_INSTALL_PREFIX}/lib${LIB_SUFFIX}"
)

INSTALL(
	TARGETS      charon
	EXPORT       ${PROJECT_NAME}
	RUNTIME      DESTINATION bin
	LIBRARY      DESTINATION lib${LIB_SUFFIX}
	ARCHIVE      DESTINATION lib${LIB_SUFFIX}
	COMPONENT    applications
)

OPTION(ENABLE_LOCAL_GETOPT "Don't use system getopt, build own one" ${WIN32})
IF(ENABLE_LOCAL_GETOPT)
	ADD_DEFINITIONS(-DSTANDALONE_GETOPT)
	ADD_LIBRARY(getopt STATIC getopt.c getopt_standalone.h)
	TARGET_LINK_LIBRARIES(charon getopt)
ENDIF(ENABLE_LOCAL_GETOPT)
