IF(MSVC)
	# Variable holding needed dlls
	SET(QT_QT_DLLS)
	# Qt dlls
	FIND_FILE(QT_QTCORE_DLL
		QtCore4.dll
		HINTS ${QT_BINARY_DIR}
		PATHS $ENV{PATH}
	)
	FIND_FILE(QT_QTGUI_DLL
		QtGui4.dll
		HINTS ${QT_BINARY_DIR}
		PATHS $ENV{PATH}
	)
	FIND_FILE(QT_PHONON_DLL
		phonon4.dll
		HINTS ${QT_BINARY_DIR}
		PATHS $ENV{PATH}
	)
	INSTALL(FILES
		${QT_QTCORE_DLL}
		${QT_QTGUI_DLL}
		${QT_PHONON_DLL}
		DESTINATION    bin
		COMPONENT      dlls
	)
	LIST(APPEND QT_QT_DLLS
		${QT_QTCORE_DLL}
		${QT_QTGUI_DLL}
		${QT_PHONON_DLL}
	)
	MARK_AS_ADVANCED(
		QT_QTCORE_DLL
		QT_QTGUI_DLL
		QT_PHONON_DLL
	)

	# Debug Qt libraries
	FIND_FILE(QT_QTCORE_DLL_DEBUG
		QtCored4.dll
		HINTS ${QT_BINARY_DIR}
		PATHS $ENV{PATH}
	)
	FIND_FILE(QT_QTGUI_DLL_DEBUG
		QtGuid4.dll
		HINTS ${QT_BINARY_DIR}
		PATHS $ENV{PATH}
	)
	FIND_FILE(QT_PHONON_DLL_DEBUG
		phonond4.dll
		HINTS ${QT_BINARY_DIR}
		PATHS $ENV{PATH}
	)
	MARK_AS_ADVANCED(
		QT_QTCORE_DLL_DEBUG
		QT_QTGUI_DLL_DEBUG
		QT_PHONON_DLL_DEBUG
	)

	INSTALL(FILES
		${QT_QTCORE_DLL_DEBUG}
		${QT_QTGUI_DLL_DEBUG}
		${QT_PHONON_DLL_DEBUG}
		DESTINATION    bin
		CONFIGURATIONS Debug
		COMPONENT      dlls
		OPTIONAL
	)
	LIST(APPEND QT_QT_DLLS
		${QT_QTCORE_DLL_DEBUG}
		${QT_QTGUI_DLL_DEBUG}
		${QT_PHONON_DLL_DEBUG}
	)
	
	# Variable holding additional dlls to be installed
	IF(ADDITIONAL_DLL_DEPENDS)
		INSTALL(FILES
			${ADDITIONAL_DLL_DEPENDS}
			DESTINATION    bin
			COMPONENT      dlls
		)
		MARK_AS_ADVANCED(
			ADDITIONAL_DLL_DEPENDS
		)
	ENDIF(ADDITIONAL_DLL_DEPENDS)
	SET(QT_QT_DLLS ${QT_QT_DLLS} CACHE STRING "Qt DLLs needed by Tuchulcha" FORCE)
	
	ADD_CUSTOM_TARGET(dlls
        COMMENT "Copying needed DLLs to build directory"
	)
	SET_TARGET_PROPERTIES(dlls PROPERTIES FOLDER "HelperTargets")
	FOREACH(X ${ADDITIONAL_DLL_DEPENDS} ${QT_QT_DLLS})
		ADD_CUSTOM_COMMAND(TARGET POST_BUILD dlls
			COMMAND "${CMAKE_COMMAND}" -E copy_if_different
				"${X}" "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/$(Configuration)"
		)
	ENDFOREACH(X)
ENDIF(MSVC)